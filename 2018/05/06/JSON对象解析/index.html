<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>JSON对象解析小工具 | laofuzi123</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="好久好久好久没有写东西，不想找理由，因为自己变懒了。每天高负荷的工作有点hot不住。为了补补先上一张美图。O(∩_∩)O  说说写这篇文章的由来。主要还是根据自己工作所遇到的现状产生的想法。现在随着编程的越来越接口化，我们的数据基本上由原来的entity对象演变成了json格式的数据。我们需要频繁的将json字符串转化成json对象然后一层一层的遍历，根据key来获取对应的值。如果嵌套只有一层两层">
<meta property="og:type" content="article">
<meta property="og:title" content="JSON对象解析小工具">
<meta property="og:url" content="http://yoursite.com/2018/05/06/JSON对象解析/index.html">
<meta property="og:site_name" content="laofuzi123">
<meta property="og:description" content="好久好久好久没有写东西，不想找理由，因为自己变懒了。每天高负荷的工作有点hot不住。为了补补先上一张美图。O(∩_∩)O  说说写这篇文章的由来。主要还是根据自己工作所遇到的现状产生的想法。现在随着编程的越来越接口化，我们的数据基本上由原来的entity对象演变成了json格式的数据。我们需要频繁的将json字符串转化成json对象然后一层一层的遍历，根据key来获取对应的值。如果嵌套只有一层两层">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/7907118-db0936857e7877db.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/7907118-3dc406f34e1f1995.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/7907118-f1d8f4e464d6687b.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/7907118-3e0313a6dbe538f1.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2018-05-06T16:11:11.319Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="JSON对象解析小工具">
<meta name="twitter:description" content="好久好久好久没有写东西，不想找理由，因为自己变懒了。每天高负荷的工作有点hot不住。为了补补先上一张美图。O(∩_∩)O  说说写这篇文章的由来。主要还是根据自己工作所遇到的现状产生的想法。现在随着编程的越来越接口化，我们的数据基本上由原来的entity对象演变成了json格式的数据。我们需要频繁的将json字符串转化成json对象然后一层一层的遍历，根据key来获取对应的值。如果嵌套只有一层两层">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/7907118-db0936857e7877db.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
  
    <link rel="alternate" href="/atom.xml" title="laofuzi123" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">laofuzi123</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-JSON对象解析" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/06/JSON对象解析/" class="article-date">
  <time datetime="2018-05-06T15:56:02.539Z" itemprop="datePublished">2018-05-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      JSON对象解析小工具
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>好久好久好久没有写东西，不想找理由，因为自己变懒了。每天高负荷的工作有点hot不住。为了补补先上一张美图。O(∩_∩)O<img src="https://upload-images.jianshu.io/upload_images/7907118-db0936857e7877db.jpg?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="2013012120082043984.jpg"></p>
<p> 说说写这篇文章的由来。主要还是根据自己工作所遇到的现状产生的想法。现在随着编程的越来越接口化，我们的数据基本上由原来的entity对象演变成了json格式的数据。我们需要频繁的将json字符串转化成json对象然后一层一层的遍历，根据key来获取对应的值。如果嵌套只有一层两层还好我们通过一两次循环就能取到我们所需要的值，如果嵌套很深的化。我们应该怎么办? 还是一层一层循环去解析然后在一层一层获取，这显然是费力不讨好的活。</p>
<p>由于本人的语文水平一直处于及格水平线上徘徊，所以给大家准备了一个小栗子来说明。<br>json格式的样例数据</p>
<pre><code>{
    &quot;data&quot;:{
        &quot;order&quot;:[
            {
                &quot;money&quot;:&quot;15&quot;,
                &quot;orders&quot;:[
                    {
                        &quot;b1&quot;:[
                                {
                                    &quot;bc1&quot;:&quot;1&quot;,
                                    &quot;bc2&quot;:&quot;2&quot;
                                },{
                                    &quot;bc1&quot;:&quot;2&quot;,
                                    &quot;bc2&quot;:&quot;3&quot;
                                }
                            ],
                        &quot;b2&quot;:&quot;2&quot;
                    },{
                        &quot;b1&quot;:[
                                {
                                    &quot;bc1&quot;:&quot;1&quot;,
                                    &quot;bc2&quot;:&quot;2&quot;
                                },{
                                    &quot;bc1&quot;:&quot;2&quot;,
                                    &quot;bc2&quot;:&quot;3&quot;
                                }
                            ],
                        &quot;b2&quot;:&quot;3&quot;
                    }
                ]
            },{
                &quot;money&quot;:&quot;16&quot;,
                &quot;orders&quot;:[
                    {
                        &quot;b1&quot;:[
                                {
                                    &quot;bc1&quot;:&quot;1&quot;,
                                    &quot;bc2&quot;:&quot;2&quot;
                                },{
                                    &quot;bc1&quot;:&quot;2&quot;,
                                    &quot;bc2&quot;:&quot;3&quot;
                                }
                            ],
                        &quot;b2&quot;:&quot;2&quot;
                    },{
                        &quot;b1&quot;:[
                                {
                                    &quot;bc1&quot;:&quot;1&quot;,
                                    &quot;bc2&quot;:&quot;2&quot;
                                },{
                                    &quot;bc1&quot;:&quot;2&quot;,
                                    &quot;bc2&quot;:&quot;3&quot;
                                }
                            ],
                        &quot;b2&quot;:&quot;3&quot;
                    }
                ]
            },{
                &quot;money&quot;:&quot;17&quot;,
                &quot;orders&quot;:[
                    {
                        &quot;b1&quot;:[
                                {
                                    &quot;bc1&quot;:&quot;1&quot;,
                                    &quot;bc2&quot;:&quot;2&quot;
                                },{
                                    &quot;bc1&quot;:&quot;2&quot;,
                                    &quot;bc2&quot;:&quot;3&quot;
                                }
                            ],
                        &quot;b2&quot;:&quot;2&quot;
                    },{
                        &quot;b1&quot;:[
                                {
                                    &quot;bc1&quot;:&quot;1&quot;,
                                    &quot;bc2&quot;:&quot;2&quot;
                                },{
                                    &quot;bc1&quot;:&quot;2&quot;,
                                    &quot;bc2&quot;:&quot;3&quot;
                                }
                            ],
                        &quot;b2&quot;:&quot;3&quot;
                    }
                ]
            }
        ],
        &quot;info&quot;:{
            &quot;record&quot;:[
                {
                    &quot;a1&quot;:&quot;1&quot;,
                    &quot;a2&quot;:&quot;2&quot;
                },
                {
                    &quot;a1&quot;:&quot;1&quot;,
                    &quot;a2&quot;:&quot;2&quot;
                },
                {
                    &quot;a1&quot;:&quot;1&quot;,
                    &quot;a2&quot;:&quot;2&quot;
                }
            ]
        }
    },
    &quot;time&quot;:{
        &quot;addr&quot;:&quot;123&quot;,
        &quot;num&quot;:{
            &quot;a&quot;:&quot;111&quot;,
            &quot;b&quot;:&quot;222&quot;
        }
    }

}
</code></pre><p>这其实还不算一个嵌套很深的数据，但是如果我需要去除key b1下面的所有元素，你会如何获取…… 大家不妨动动手中笔，如果是你会怎么解决这个问题，并将其做成一个通用的方法。如果有好的方案，欢迎给我留言，不胜感激。</p>
<p>废话就不多说了，我谈谈自己的戳见。首先我们解析json字符串的肯定直接解析不行的，那样太费事。我们可以借助GSON提供的工具类将json转化成对应的对象,转化后大致的格式是这样的：<br><img src="https://upload-images.jianshu.io/upload_images/7907118-3dc406f34e1f1995.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="捕获.PNG"></p>
<p>根据上面的结构图 我们可以知道 我们如果需要获取到key为b1对应的所有对象 我们需要结果这些key  data order orders b1 那么我们何不将这些key用 (.)关联起来组成一个jsonKey = data.order.orders.b1 。有了想法我们就可以动手行动了。这里详细的过程我就不说了，代码的难度不大，只是看我们想不想去做这件事。代码如下：</p>
<pre><code> // 将提取方法进行封装成方法 方便调用
    public static Object getKeyJsonQuery(Map&lt;?,?&gt; map ,String jsonKey){
        String[] arrs = jsonKey.split(&quot;\\.&quot;);
        Object obj = null;
        for(int i=0;i&lt;arrs.length;i++){
            if(i==0) {
                obj = handle(map, arrs[i]);
            }else{
                if(obj instanceof Map){
                    obj = handle((Map&lt;?, ?&gt;) obj,arrs[i]);
                }else if(obj instanceof List){
                    obj = handle((List&lt;Map&lt;?, ?&gt;&gt;) obj,arrs[i]);
                }
            }
        }
        return obj;
    }
    //解析map类型的对象
    public static Object handle(Map&lt;?,?&gt; map,String key){
        return map.get(key);
    }
    // 解析list类型的对象
    public static Object handle(List&lt;Map&lt;?,?&gt;&gt; listMap,String key){
        List&lt;Map&lt;String,Object&gt;&gt; listMaps = new ArrayList&lt;&gt;();
        List&lt;Object&gt; lists = new ArrayList&lt;&gt;();
        // 这里用到了java8的一个新特性 stream 流
        listMap.stream().filter(e-&gt;null !=e.get(key) ).map(e-&gt;{
            //表示既不是map 又不是list类型
            if(!(e.get(key) instanceof Map&lt;?,?&gt;) &amp;&amp; !(e.get(key) instanceof List&lt;?&gt;) ) {
                return lists.add(e.get(key));
            }else{
                return listMaps.addAll((Collection&lt;? extends Map&lt;String, Object&gt;&gt;) e.get(key));
            }
        }).collect(Collectors.toList());
        // 返回一个不为空的对象并且集合元素大于0 这里为什么不需要考虑两个判断 因为如果两个都为空表示 是空没有获取到值
        return lists.size()&gt;0 &amp;&amp; !lists.isEmpty() ? lists:listMaps;
    }

public static void main(String[] args) throws Exception {
       String json = &quot;{\&quot;data\&quot;:{\&quot;order\&quot;:[{\&quot;money\&quot;:\&quot;15\&quot;,\&quot;orders\&quot;:[{\&quot;b1\&quot;:[{\&quot;bc1\&quot;:\&quot;1\&quot;,\&quot;bc2\&quot;:\&quot;2\&quot;},{\&quot;bc1\&quot;:\&quot;2\&quot;,\&quot;bc2\&quot;:\&quot;3\&quot;}],\&quot;b2\&quot;:\&quot;2\&quot;},{\&quot;b1\&quot;:[{\&quot;bc1\&quot;:\&quot;1\&quot;,\&quot;bc2\&quot;:\&quot;2\&quot;},{\&quot;bc1\&quot;:\&quot;2\&quot;,\&quot;bc2\&quot;:\&quot;3\&quot;}],\&quot;b2\&quot;:\&quot;3\&quot;}]},{\&quot;money\&quot;:\&quot;16\&quot;,\&quot;orders\&quot;:[{\&quot;b1\&quot;:[{\&quot;bc1\&quot;:\&quot;1\&quot;,\&quot;bc2\&quot;:\&quot;2\&quot;},{\&quot;bc1\&quot;:\&quot;2\&quot;,\&quot;bc2\&quot;:\&quot;3\&quot;}],\&quot;b2\&quot;:\&quot;2\&quot;},{\&quot;b1\&quot;:[{\&quot;bc1\&quot;:\&quot;1\&quot;,\&quot;bc2\&quot;:\&quot;2\&quot;},{\&quot;bc1\&quot;:\&quot;2\&quot;,\&quot;bc2\&quot;:\&quot;3\&quot;}],\&quot;b2\&quot;:\&quot;3\&quot;}]},{\&quot;money\&quot;:\&quot;17\&quot;,\&quot;orders\&quot;:[{\&quot;b1\&quot;:[{\&quot;bc1\&quot;:\&quot;1\&quot;,\&quot;bc2\&quot;:\&quot;2\&quot;},{\&quot;bc1\&quot;:\&quot;2\&quot;,\&quot;bc2\&quot;:\&quot;3\&quot;}],\&quot;b2\&quot;:\&quot;2\&quot;},{\&quot;b1\&quot;:[{\&quot;bc1\&quot;:\&quot;1\&quot;,\&quot;bc2\&quot;:\&quot;2\&quot;},{\&quot;bc1\&quot;:\&quot;2\&quot;,\&quot;bc2\&quot;:\&quot;3\&quot;}],\&quot;b2\&quot;:\&quot;3\&quot;}]}],\&quot;info\&quot;:{\&quot;record\&quot;:[{\&quot;a1\&quot;:\&quot;1\&quot;,\&quot;a2\&quot;:\&quot;2\&quot;},{\&quot;a1\&quot;:\&quot;1\&quot;,\&quot;a2\&quot;:\&quot;2\&quot;},{\&quot;a1\&quot;:\&quot;1\&quot;,\&quot;a2\&quot;:\&quot;2\&quot;}]}},\&quot;time\&quot;:{\&quot;addr\&quot;:\&quot;123\&quot;,\&quot;num\&quot;:{\&quot;a\&quot;:\&quot;111\&quot;,\&quot;b\&quot;:\&quot;222\&quot;}}}&quot;;
        Gson gson = new Gson();
        Map&lt;String,Object&gt; map = gson.fromJson(json, Map.class);
        System.out.println(map.toString());
        String jsonKey = &quot;data.order.orders.b1.bc1&quot;;
        //String jsonKey = &quot;time.num.a&quot;;
        //String jsonKey =&quot;data.info&quot;;
       Object obj =  getKeyJsonQuery(map,jsonKey);
       System.out.println(obj.toString());
    }
</code></pre><p>附上几张key对应结果<br>key=data.order.orders.b1<img src="https://upload-images.jianshu.io/upload_images/7907118-f1d8f4e464d6687b.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="捕获1.PNG"><br>key = data.order.orders.b1.bc1<img src="https://upload-images.jianshu.io/upload_images/7907118-3e0313a6dbe538f1.PNG?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="捕获2.PNG"></p>
<p>基本上都可以适应大部分场景，这也算是一个小小的工具方法。个人认为也还是比较有实用价值。其中用到了java8 stream的特性，如果不是很了解，建议去网上查查这方面的只是，stream对于集合的操作的便利性大大的提高了效率。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/06/JSON对象解析/" data-id="cjgwc5drj00023k6tiz6e9s97" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/05/07/springNote/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          spring知识点
        
      </div>
    </a>
  
  
    <a href="/2018/05/06/FirstNight/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title"></div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/05/07/springNote/">spring知识点</a>
          </li>
        
          <li>
            <a href="/2018/05/06/JSON对象解析/">JSON对象解析小工具</a>
          </li>
        
          <li>
            <a href="/2018/05/06/FirstNight/">(no title)</a>
          </li>
        
          <li>
            <a href="/2018/05/06/hello-world/">Hello World</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 laofuzi<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>